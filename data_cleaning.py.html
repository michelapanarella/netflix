
# coding: utf-8

# In[2]:


import pandas as pd
import numpy as np
import matplotlib as plt
import math

netflix = pd.read_csv("/Users/Michela/Desktop/netflix_titles.csv")
#netflix = pd.read_csv("~/netflix_titles.csv")


# In[4]:


netflix.head()
#To clean the data: 
#0. count missing
#1. get the date added in datetime format
#2. Get the year the film was made
#3. Clean up the ratings as there are a lot of categories


# In[6]:


#evaluate the missings
missing=pd.DataFrame({'missing': netflix.isnull().sum()})
missing
#not a lot of missing overall - most missing is from director/country of origin/cast


# In[7]:


#change the date/time
netflix["date_added"] = pd.to_datetime(netflix['date_added'])
netflix['year_added'] = (netflix['date_added'].dt.year)


# In[9]:


#raitngs before cleanups
netflix['rating'].value_counts().plot.barh()



#majority are TV-MA - very few children's items


# In[10]:


#The ratings categories should be: R, MA, 14A, PG-13, PG, G, NR

#to do so, we will change the ratings below. 
#UR -> NR
#NC-17 ->MA
#TV-Y7-FV, TV-Y, TY-G -> G
#TV-PG -> PG
#TV-14 -> 14A
#TV-MA -> MA

netflix['rating'] = netflix['rating'].map({'UR': "NR", 'NC-17': "MA", "TV-MA":"MA", "TV-Y7-FV":"G", "G":"G",
                                              "TV-Y":"G", "TV-G":"G", "TV-Y7":"G","PG":"PG", "NR":"NR","PG-13":"PG-13",
                                              "R":"R", "TV-PG":"PG", "TV-14":"14A"})

#fewer ratings but more in each rating category 
netflix['rating'].value_counts().plot.barh()

